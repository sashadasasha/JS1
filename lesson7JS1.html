<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title> Урок 6 Задание 1 </title>
  <style>
    div {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    p {
      font-size: 25px;
      color: blue;
      font-weight: bold;
    }

    .product {
      display: flex;
      justify-content: space-between;
    }

    .prod {
      display: flex;
      flex-direction: column;
    }

    .prod input {
      margin-top: 5px;
    }

    .prod img {
      width: 300px;
      height: 300px;
    }

    .prod button {
      margin-top: 25px;
    }

    #cart {
      display:flex;
      flex-direction: column;
      margin-top: 30px;
    }
  </style>
</head>

<body>
  <div class="products" id="products">
    <div class="prod" id="prod_milk"><img src="/img_prod/milk.jpg">
      <p>Количество</p>
      <!--<input type="number" id="amount" placeholder="0" min="0">-->
      <p>Цена: 30р</p>
      <button>Добавить в корзину</button>
    </div>
    <div class="prod" id="prod_butter"><img src="/img_prod/butter.jpg">
      <p>Количество</p>
      <!--<input type="number" id="amount" placeholder="0" min="0">-->
      <p>Цена: 180р</p><button>Добавить в корзину</button>
    </div>
    <div class="prod" id="prod_bread"><img src="/img_prod/bread.jpg">
      <p>Количество</p>
      <!--<input type="number" id="amount" placeholder="0" min="0">-->
      <p>Цена: 15р</p><button>Добавить в корзину</button>
    </div>
    <div class="prod" id="prod_cheese"><img src="/img_prod/cheese.jpg">
      <p>Количество</p>
      <!--<input type="number" id="amount" placeholder="0" min="0">-->
      <p>Цена: 300р</p><button>Добавить в корзину</button>
    </div>
    <div class="prod" id="prod_meat"><img src="/img_prod/meat.JPG">
      <p>Количество</p>
      <!--<input type="number" id="amount" placeholder="0" min="0">-->
      <p>Цена: 450р</p><button>Добавить в корзину</button>
    </div>
  </div>
  <div id="cart">
    <h3>Ваша корзина</h3>
    <p></p>
    <div id = "cart_info"></div>
  </div>
  <script>
    "use strict";

    const products = {
      prod_milk: {
        name: "milk",
        price: 30,
      },
      prod_butter: {
        name: "butter",
        price: 180,
      },
      prod_bread: {
        name: "bread",
        price: 15,
      },
      prod_cheese: {
        name: "cheese",
        price: 300,
      },
      prod_meat: {
        name: "meat",
        price: 450
      },

    };

    const cart = {
      productsCart: {},
      cartSum: 0,

      cartAdd: function (event) {
        if (event.target.nodeName === "BUTTON") {
          let $prod = document.querySelectorAll('button');
          let $idName = event.target.parentElement.id;
          let prodKey = Object.keys(products);
          for (let i = 0; i < prodKey.length; i++) {
            if (prodKey[i] === $idName) {
              cart.productsCart[$idName] = products[prodKey[i]];

            }
          }
          cart.countBasketPrice();
          const cartInfo = function () {
          const cartMessageField = document.getElementById('cart_info');
          const $infoField = document.createElement('div');
          $infoField.classList.add('info');
          cartMessageField.appendChild($infoField);
          const $prodName = document.createElement('p');
          $prodName.classList.add('prod_name');
          $infoField.appendChild($prodName);
          $prodName.innerHTML = cart.productsCart[$idName].name;

      }
        cartInfo();
        }
      },

      cartBuilder: function () {

        let $products = document.querySelector('.products');
        $products.addEventListener('click', this.cartAdd);

      },

      countBasketPrice: function () {
        if (this.productsCart == undefined) {
          return this.cartSum = 0;
        } else {
          this.cartSum = 0;
          for (let prod in this.productsCart) {
            this.cartSum += this.productsCart[prod].price;
          }
          cart.cartText();
          return this.cartSum;
        }
      },

      countAmount: function () {

      },

      cartInfo: function () {
        const cartMessageField = document.getElementById('cart');
        const $infoField = document.createElement('div');
        $infoField.classList.add('info');

      },
      cartText: function () {
        const cartMessageField = document.getElementById('cart');
        const elemP = document.querySelector('#cart > p');
        const delP = cartMessageField.removeChild(elemP);
        const cartMessage = document.createElement('p');
        cartMessageField.appendChild(cartMessage);
        let text;
        if (this.cartSum === 0) {
          text = "Вы пока ничего не купили";
        } else {
          text = `В вашей корзине всего товаров на сумму ${this.cartSum} рублей`;
        }
        cartMessage.textContent = text;
      }
    };

    cart.cartBuilder();
    cart.cartText();
  </script>
</body>

</html>